function h = lkaSegment_gui(varargin)
%UNTITLED2 Summary of this function goes here
%   Detailed explanation goes here

close all


%  Initialize and hide the GUI as it is being constructed
h.guifig = figure(...
    'MenuBar','none',...
    'Position',[0 0 800 400],...
    'Toolbar','figure',...
    'Visible','on');


%%% positions of ui-elements %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
height_edit = 22;
width_edit = 80;
height_text = 15;
width_text = 50;


%%% some colors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
color_default = [240 240 240]/255;



%%% place the ui-elements %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%
%%% group into panels
%%%%%%%%%%%%%%%%%%%%%



h.secDef.group = uipanel(...
    'FontSize',8,...
    'FontWeight','bold',...
    'Position',[0.015 0.02 .45 0.96],...
    'Tag','groupRB',... % used for referencing
    'Title','Street section',...
    'TitlePosition','lefttop',...
    'Visible','on');

h.vis.group = uipanel(...
    'BackgroundColor',color_default,...
    'FontSize',8,...
    'FontWeight','bold',...
    'Position',[.5 .02 .45 .96],...
    'Tag','groupVis',...
    'Title','Visualization');


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% add buttons, boxes, etc. to groups
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

units_rb = 'pixels';
pos_left = 10;
pos_top = 340;
pos_bot = 15;
height_radiobutton = 20;
width_radiobutton = 80;

%%% definition street section
h.secDef.popup(1) = uicontrol('Style','popupmenu',...
    'BackgroundColor',color_default,...
    'Callback',@popup_Callback,...
    'Units',units_rb,... % have to be specified before 'Posiion'
    'Position',[pos_left pos_top width_radiobutton height_radiobutton],...
    'Parent',h.secDef.group,...
    'String','|Straight|Circle|Clothoid',...
    'Tag','dropdown');

h.secDef.edit(1) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Length:','0','m'},...
    'secDef:length',...
    [pos_left 300]);

h.secDef.edit(2) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Angle (start):','0','°'},...
    'secDef:angle',...
    [pos_left 290]);

h.secDef.edit(3) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Angle stop:','0','°'},...
    'secDef:angleStop',...
    [pos_left 280]);

h.secDef.edit(4) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Radius:','0','m'},...
    'secDef:radius',...
    [pos_left 270]);

h.secDef.edit(5) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Curvature start:','0','1/m'},...
    'secDef:curvStart',...
    [pos_left 260]);

h.secDef.edit(6) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'Curvature stop:','0','1/m'},...
    'secDef:curvStop',...
    [pos_left 250]);

h.secDef.edit(7) = textCtrl_LabelValueUnit(...
    color_default,...
    h.secDef.group,...
    {'A:','0','m'},...
    'secDef:A',...
    [pos_left 150]);

align([h.secDef.edit(:).label],'None','Distribute');
align([h.secDef.edit(:).value],'None','Distribute');
align([h.secDef.edit(:).unit],'None','Distribute');


%%% init gui

% disable all edit-controls
set([h.secDef.edit(:).value],'Enable','off')

% Move the GUI to the left of the screen.
movegui(h.guifig,'northwest')



end%fcn


function popup_Callback(hObject,eventdata)

val = get(hObject,'Value');

switch val
    case 1 % empty
        list = {};
    case 2 % straight
        list = {'secDef:length','secDef:angle'};
    case 3 % circle
        list = {'secDef:angleStop','secDef:angle','secDef:radius'};
    case 4 % circle
        list = {'secDef:curvStart','secDef:curvStop','secDef:angle','secDef:A'};
    otherwise
end%switch

% handle to all edit-controls
hEdit = findobj('style','edit');

% disable all edit-controls
set(hEdit,'Enable','off')

% get handles of list
for i = 1:length(list)
    h(i) = findobj('Tag',[list{i},':value']);
end

% enable
set(h,'Enable','on')


end%fcn


function h = textCtrl_LabelValueUnit(col,par,str,tag,pos)

% some parameter
height_label = 15;
height_value = 20;
height_unit = 15;
width_label = 80;
width_value = 50;
width_unit = 50;
offset_label_value = 5;
offset_value_unit = 5;


% label
h.label = uicontrol('Style','text',...
    'BackgroundColor',col,...
    'HorizontalAlignment','right',...
    'Parent',par,...
    'Position',[pos,width_label,height_label],...
    'String',str{1},...
    'Tag',[tag,':label']);

% value
pos = [pos(1)+width_label+offset_label_value pos(2)];
h.value = uicontrol('Style','edit',...
    'BackgroundColor','white',...
    'HorizontalAlignment','right',...
    'Parent',par,...
    'Position',[pos,width_value,height_value],...
    'String',str{2},...
    'Tag',[tag,':value']);

% unit
pos = [pos(1)+width_value+offset_value_unit pos(2)];
h.unit = uicontrol('Style','text',...
    'BackgroundColor',col,...
    'HorizontalAlignment','left',...
    'Parent',par,...
    'Position',[pos,width_unit,height_unit],...
    'String',str{3},...
    'Tag',[tag,':unit']);


align([h.label,h.value,h.unit],'None','Middle');

end%fcn